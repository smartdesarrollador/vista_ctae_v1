<section id="experience" class="cv-section">
  <div class="cv-card p-4 sm:p-6 md:p-8" data-aos="cv-fade-up" data-aos-delay="400">
    <h2 class="cv-section-title">Experiencia Profesional</h2>
    
    <!-- Loading State -->
    <div *ngIf="isLoading" class="animate-pulse cv-spacing-lg">
      <div *ngFor="let item of [1,2,3]" class="cv-timeline-item">
        <div class="cv-timeline-dot bg-gray-300"></div>
        <div class="ml-4 space-y-3">
          <div class="h-6 bg-gray-200 rounded w-2/3"></div>
          <div class="h-5 bg-gray-200 rounded w-1/2"></div>
          <div class="h-4 bg-gray-200 rounded w-1/3"></div>
          <div class="h-4 bg-gray-200 rounded w-full"></div>
          <div class="flex gap-2">
            <div class="h-6 bg-gray-200 rounded w-16"></div>
            <div class="h-6 bg-gray-200 rounded w-16"></div>
            <div class="h-6 bg-gray-200 rounded w-16"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Content -->
    <div *ngIf="!isLoading" class="cv-spacing-lg">
      <div *ngFor="let exp of experience; let i = index" 
           class="cv-timeline-item group"
           data-aos="cv-fade-up" 
           [attr.data-aos-delay]="(i * 100) + 500">
        
        <!-- Timeline Dot -->
        <div class="cv-timeline-dot group-hover:scale-125 transition-all duration-300 shadow-lg"></div>
        
        <!-- Content -->
        <div class="ml-2 sm:ml-4">
          <!-- Position & Company -->
          <div class="mb-3">
            <h3 class="text-lg sm:text-xl font-bold text-gray-900 mb-1 group-hover:text-blue-600 transition-colors duration-200">
              {{ exp.position }}
            </h3>
            <div class="flex flex-wrap items-center gap-2 sm:gap-3 mb-2">
              <!-- Company Logo -->
              <div class="flex items-center gap-2 sm:gap-3">
                <div *ngIf="exp.companyLogo" 
                     class="w-6 h-6 sm:w-8 sm:h-8 rounded-md overflow-hidden bg-gray-100 flex-shrink-0">
                  <img [src]="exp.companyLogo" 
                       [alt]="exp.company + ' logo'"
                       class="w-full h-full object-contain">
                </div>
                <div *ngIf="!exp.companyLogo" 
                     class="w-6 h-6 sm:w-8 sm:h-8 rounded-md bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center flex-shrink-0">
                  <span class="text-white text-xs sm:text-sm font-bold">{{ getCompanyInitials(exp.company) }}</span>
                </div>
                <span class="text-blue-600 font-semibold text-base sm:text-lg">{{ exp.company }}</span>
              </div>
              <span class="text-gray-400 hidden sm:inline">‚Ä¢</span>
              <div class="flex items-center gap-1 text-sm sm:text-base">
                <span class="text-gray-500">üìç</span>
                <span class="text-gray-600">{{ exp.location }}</span>
              </div>
            </div>
          </div>
          
          <!-- Date Range and Duration -->
          <div class="flex flex-wrap items-center gap-2 sm:gap-4 mb-3">
            <div class="flex items-center gap-1 sm:gap-2 text-gray-500">
              <div class="w-4 h-4 sm:w-5 sm:h-5 bg-blue-100 rounded-full flex items-center justify-center">
                <span class="text-xs">üìÖ</span>
              </div>
              <span class="text-xs sm:text-sm font-medium">
                {{ formatDateRange(exp.startDate, exp.endDate) }}
              </span>
            </div>
            <div class="flex items-center gap-1 sm:gap-2 text-gray-500">
              <div class="w-4 h-4 sm:w-5 sm:h-5 bg-green-100 rounded-full flex items-center justify-center">
                <span class="text-xs">‚è∞</span>
              </div>
              <span class="text-xs sm:text-sm">
                {{ calculateDuration(exp.startDate, exp.endDate) }}
              </span>
            </div>
          </div>
          
          <!-- Employment Type -->
          <div *ngIf="exp.employmentType" class="mb-3">
            <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
              {{ exp.employmentType }}
            </span>
          </div>
          
          <!-- Description -->
          <div class="mb-4">
            <p class="text-gray-600 leading-relaxed text-justify text-sm sm:text-base">{{ exp.description }}</p>
          </div>
          
          <!-- Key Achievements -->
          <div *ngIf="exp.achievements && exp.achievements.length > 0" class="mb-4">
            <h4 class="font-semibold text-gray-800 mb-2 text-sm sm:text-base">Logros Destacados:</h4>
            <ul class="space-y-1">
              <li *ngFor="let achievement of exp.achievements" 
                  class="flex items-start gap-2 text-xs sm:text-sm text-gray-600">
                <span class="text-green-500 mt-0.5 flex-shrink-0">‚úì</span>
                <span class="text-justify">{{ achievement }}</span>
              </li>
            </ul>
          </div>
          
          <!-- Technologies -->
          <div class="flex flex-wrap gap-1 sm:gap-2">
            <span *ngFor="let tech of exp.technologies" 
                  class="cv-badge cv-badge-primary hover:bg-blue-200 transition-colors duration-200 cursor-default text-xs sm:text-sm">
              {{ tech }}
            </span>
          </div>
        </div>
      </div>
      
      <!-- Empty State -->
      <div *ngIf="experience.length === 0" 
           class="text-center py-12"
           data-aos="cv-fade-up" 
           data-aos-delay="500">
        <div class="text-6xl mb-4">üíº</div>
        <h3 class="text-xl font-semibold text-gray-700 mb-2">No hay experiencia disponible</h3>
        <p class="text-gray-500">La informaci√≥n de experiencia se cargar√° pr√≥ximamente.</p>
      </div>
    </div>
  </div>
</section>
